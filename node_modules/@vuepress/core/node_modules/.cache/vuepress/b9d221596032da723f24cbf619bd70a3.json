{"remainingRequest":"/Users/hrslab/Documents/GitHub/prjdoc/node_modules/babel-loader/lib/index.js??ref--3-1!/Users/hrslab/Documents/GitHub/prjdoc/node_modules/vuepress-auth0/dist/authService.js","dependencies":[{"path":"/Users/hrslab/Documents/GitHub/prjdoc/node_modules/vuepress-auth0/dist/authService.js","mtime":1604845538203},{"path":"/Users/hrslab/Documents/GitHub/prjdoc/node_modules/cache-loader/dist/cjs.js","mtime":1604845479153},{"path":"/Users/hrslab/Documents/GitHub/prjdoc/node_modules/babel-loader/lib/index.js","mtime":1604845478936}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS5ub3ciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5lbnRyaWVzIjsKaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tICJ0c2xpYiI7CmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gImV2ZW50cyI7CnZhciBsb2NhbFN0b3JhZ2VLZXkgPSAibG9nZ2VkSW4iOwp2YXIgaXNCcm93c2VyID0gdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB0cnVlIDogZmFsc2U7CnZhciBXZWJBdXRoOwoKaWYgKGlzQnJvd3NlcikgewogIFdlYkF1dGggPSByZXF1aXJlKCdhdXRoMC1qcycpLldlYkF1dGg7Cn0gZWxzZSB7CiAgV2ViQXV0aCA9IHt9Owp9Cgp2YXIgQXV0aFNlcnZpY2UgPSBmdW5jdGlvbiAoX3N1cGVyKSB7CiAgdHNsaWJfMS5fX2V4dGVuZHMoQXV0aFNlcnZpY2UsIF9zdXBlcik7CgogIGZ1bmN0aW9uIEF1dGhTZXJ2aWNlKG9wdGlvbnMsIHJvdXRlcikgewogICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpczsKCiAgICBfdGhpcy5hdXRoMCA9IG5ldyBXZWJBdXRoKHRzbGliXzEuX19hc3NpZ24oewogICAgICByZXNwb25zZVR5cGU6ICdpZF90b2tlbicsCiAgICAgIHNjb3BlOiAnb3BlbmlkIHByb2ZpbGUgZW1haWwnCiAgICB9LCBvcHRpb25zKSk7CiAgICBfdGhpcy5yb3V0ZXIgPSByb3V0ZXI7CiAgICBfdGhpcy5pZFRva2VuID0gdW5kZWZpbmVkOwogICAgX3RoaXMucHJvZmlsZSA9IHVuZGVmaW5lZDsKICAgIF90aGlzLmV4cGlyZXNJbiA9IDA7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBBdXRoU2VydmljZS5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbiAoY3VzdG9tU3RhdGUpIHsKICAgIGlmICghaXNCcm93c2VyIHx8IE9iamVjdC5lbnRyaWVzKHRoaXMuYXV0aDApLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmF1dGgwLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuYXV0aDAuYXV0aG9yaXplKHsKICAgICAgYXBwU3RhdGU6IGN1c3RvbVN0YXRlCiAgICB9KTsKICB9OwoKICBBdXRoU2VydmljZS5wcm90b3R5cGUubG9nT3V0ID0gZnVuY3Rpb24gKCkgewogICAgaWYgKCFpc0Jyb3dzZXIgfHwgT2JqZWN0LmVudHJpZXModGhpcy5hdXRoMCkubGVuZ3RoID09PSAwICYmIHRoaXMuYXV0aDAuY29uc3RydWN0b3IgPT09IE9iamVjdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0obG9jYWxTdG9yYWdlS2V5KTsKICAgIHRoaXMuaWRUb2tlbiA9IHVuZGVmaW5lZDsKICAgIHRoaXMuZXhwaXJlc0luID0gMDsKICAgIHRoaXMucHJvZmlsZSA9IHVuZGVmaW5lZDsKICAgIHRoaXMuYXV0aDAubG9nb3V0KHsKICAgICAgcmV0dXJuVG86ICIiICsgd2luZG93LmxvY2F0aW9uLm9yaWdpbgogICAgfSk7CiAgfTsKCiAgQXV0aFNlcnZpY2UucHJvdG90eXBlLmhhbmRsZUF1dGhlbnRpY2F0aW9uID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHsKICAgICAgICBpZiAoIWlzQnJvd3NlciB8fCBPYmplY3QuZW50cmllcyh0aGlzLmF1dGgwKS5sZW5ndGggPT09IDAgJiYgdGhpcy5hdXRoMC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgICByZXR1cm4gWzIsICdlcnJvciddOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFsyLCB0aGlzLmF1dGgwLnBhcnNlSGFzaChmdW5jdGlvbiAoZXJyLCBhdXRoUmVzdWx0KSB7CiAgICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgIHJldHVybiBlcnI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoYXV0aFJlc3VsdCAhPT0gbnVsbCkgewogICAgICAgICAgICAgIF90aGlzLnNldFNlc3Npb24oYXV0aFJlc3VsdCk7CgogICAgICAgICAgICAgIGlmIChhdXRoUmVzdWx0LmlkVG9rZW4pIHsKICAgICAgICAgICAgICAgIHJldHVybiBhdXRoUmVzdWx0LmlkVG9rZW47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSldOwogICAgICB9KTsKICAgIH0pOwogIH07CgogIEF1dGhTZXJ2aWNlLnByb3RvdHlwZS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIWlzQnJvd3NlciB8fCBPYmplY3QuZW50cmllcyh0aGlzLmF1dGgwKS5sZW5ndGggPT09IDAgJiYgdGhpcy5hdXRoMC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpcy5leHBpcmVzSW4gJiYgRGF0ZS5ub3coKSA8IHRoaXMuZXhwaXJlc0luICYmIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGxvY2FsU3RvcmFnZUtleSkgPT09ICJ0cnVlIikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9OwoKICBBdXRoU2VydmljZS5wcm90b3R5cGUuaXNJZFRva2VuVmFsaWQgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIWlzQnJvd3NlciB8fCBPYmplY3QuZW50cmllcyh0aGlzLmF1dGgwKS5sZW5ndGggPT09IDAgJiYgdGhpcy5hdXRoMC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpcy5leHBpcmVzSW4gJiYgdGhpcy5pZFRva2VuICYmIERhdGUubm93KCkgPCB0aGlzLmV4cGlyZXNJbikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9OwoKICBBdXRoU2VydmljZS5wcm90b3R5cGUuZ2V0SWRUb2tlbiA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHsKICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGlmICghKHRoaXMuaWRUb2tlbiAmJiB0aGlzLmlzSWRUb2tlblZhbGlkKCkpKSByZXR1cm4gWzMsIDFdOwogICAgICAgICAgICByZXR1cm4gWzIsIHRoaXMuaWRUb2tlbl07CgogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBpZiAoIXRoaXMuaXNBdXRoZW50aWNhdGVkKCkpIHJldHVybiBbMywgM107CiAgICAgICAgICAgIHJldHVybiBbNCwgdGhpcy5yZW5ld1Rva2VucygpLnRoZW4oZnVuY3Rpb24gKGF1dGhSZXN1bHQpIHsKICAgICAgICAgICAgICByZXR1cm4gYXV0aFJlc3VsdC5pZFRva2VuOwogICAgICAgICAgICB9KV07CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXR1cm4gWzIsIF9hLnNlbnQoKV07CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICByZXR1cm4gWzIsICdlcnJvciBnZXR0aW5nIGlkVG9rZW4nXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgQXV0aFNlcnZpY2UucHJvdG90eXBlLnNldFNlc3Npb24gPSBmdW5jdGlvbiAoYXV0aFJlc3VsdCkgewogICAgaWYgKCFpc0Jyb3dzZXIgfHwgT2JqZWN0LmVudHJpZXModGhpcy5hdXRoMCkubGVuZ3RoID09PSAwICYmIHRoaXMuYXV0aDAuY29uc3RydWN0b3IgPT09IE9iamVjdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5pZFRva2VuID0gYXV0aFJlc3VsdC5pZFRva2VuOwogICAgdGhpcy5wcm9maWxlID0gYXV0aFJlc3VsdC5pZFRva2VuUGF5bG9hZDsKCiAgICBpZiAodGhpcy5wcm9maWxlICYmIHRoaXMucHJvZmlsZS5leHApIHsKICAgICAgdGhpcy5leHBpcmVzSW4gPSB0aGlzLnByb2ZpbGUuZXhwICogMTAwMCArIERhdGUubm93KCk7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGxvY2FsU3RvcmFnZUtleSwgInRydWUiKTsKICAgICAgdGhpcy5yb3V0ZXIucHVzaChhdXRoUmVzdWx0LmFwcFN0YXRlLnRhcmdldCk7CiAgICB9IGVsc2UgaWYgKGF1dGhSZXN1bHQuZXhwaXJlc0luKSB7CiAgICAgIHRoaXMuZXhwaXJlc0luID0gYXV0aFJlc3VsdC5leHBpcmVzSW4gKiAxMDAwICsgRGF0ZS5ub3coKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0obG9jYWxTdG9yYWdlS2V5LCAidHJ1ZSIpOwogICAgICB0aGlzLnJvdXRlci5wdXNoKGF1dGhSZXN1bHQuYXBwU3RhdGUudGFyZ2V0KTsKICAgIH0gZWxzZSB7fQogIH07CgogIEF1dGhTZXJ2aWNlLnByb3RvdHlwZS5yZW5ld1Rva2VucyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7CiAgICAgICAgaWYgKCFpc0Jyb3dzZXIgfHwgT2JqZWN0LmVudHJpZXModGhpcy5hdXRoMCkubGVuZ3RoID09PSAwICYmIHRoaXMuYXV0aDAuY29uc3RydWN0b3IgPT09IE9iamVjdCkgewogICAgICAgICAgcmV0dXJuIFsyXTsKICAgICAgICB9CgogICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShsb2NhbFN0b3JhZ2VLZXkpICE9PSAidHJ1ZSIpIHsKICAgICAgICAgIHJldHVybiBbMiwgIk5vdCBsb2dnZWQgaW4iXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBbMiwgdGhpcy5hdXRoMC5jaGVja1Nlc3Npb24oe30sIGZ1bmN0aW9uIChlcnIsIGF1dGhSZXN1bHQpIHsKICAgICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgcmV0dXJuIGVycjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzLnNldFNlc3Npb24oYXV0aFJlc3VsdCk7CgogICAgICAgICAgICByZXR1cm4gYXV0aFJlc3VsdDsKICAgICAgICAgIH0KICAgICAgICB9KV07CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgcmV0dXJuIEF1dGhTZXJ2aWNlOwp9KEV2ZW50RW1pdHRlcik7CgpleHBvcnQgZGVmYXVsdCBBdXRoU2VydmljZTs="},{"version":3,"sources":["/Users/hrslab/Documents/GitHub/prjdoc/node_modules/vuepress-auth0/dist/authService.js"],"names":["tslib_1","EventEmitter","localStorageKey","isBrowser","window","WebAuth","require","AuthService","_super","__extends","options","router","_this","call","auth0","__assign","responseType","scope","idToken","undefined","profile","expiresIn","prototype","login","customState","Object","entries","length","constructor","authorize","appState","logOut","localStorage","removeItem","logout","returnTo","location","origin","handleAuthentication","__awaiter","__generator","_a","parseHash","err","authResult","setSession","isAuthenticated","Date","now","getItem","isIdTokenValid","getIdToken","label","renewTokens","then","sent","idTokenPayload","exp","setItem","push","target","checkSession"],"mappings":"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","sourcesContent":["import * as tslib_1 from \"tslib\";\nimport { EventEmitter } from \"events\";\nvar localStorageKey = \"loggedIn\";\nvar isBrowser = typeof window !== \"undefined\" ? true : false;\nvar WebAuth;\nif (isBrowser) {\n    WebAuth = require('auth0-js').WebAuth;\n}\nelse {\n    WebAuth = {};\n}\nvar AuthService = (function (_super) {\n    tslib_1.__extends(AuthService, _super);\n    function AuthService(options, router) {\n        var _this = _super.call(this) || this;\n        _this.auth0 = new WebAuth(tslib_1.__assign({ responseType: 'id_token', scope: 'openid profile email' }, options));\n        _this.router = router;\n        _this.idToken = undefined;\n        _this.profile = undefined;\n        _this.expiresIn = 0;\n        return _this;\n    }\n    AuthService.prototype.login = function (customState) {\n        if (!isBrowser || (Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object)) {\n            return;\n        }\n        this.auth0.authorize({\n            appState: customState\n        });\n    };\n    AuthService.prototype.logOut = function () {\n        if (!isBrowser || (Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object)) {\n            return;\n        }\n        localStorage.removeItem(localStorageKey);\n        this.idToken = undefined;\n        this.expiresIn = 0;\n        this.profile = undefined;\n        this.auth0.logout({\n            returnTo: \"\" + window.location.origin\n        });\n    };\n    AuthService.prototype.handleAuthentication = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                if (!isBrowser || Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object) {\n                    return [2, ('error')];\n                }\n                return [2, this.auth0.parseHash(function (err, authResult) {\n                        if (err) {\n                            return (err);\n                        }\n                        else {\n                            if (authResult !== null) {\n                                _this.setSession(authResult);\n                                if (authResult.idToken) {\n                                    return (authResult.idToken);\n                                }\n                            }\n                        }\n                    })];\n            });\n        });\n    };\n    AuthService.prototype.isAuthenticated = function () {\n        if (!isBrowser || (Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object)) {\n            return false;\n        }\n        if (this.expiresIn && (Date.now() < this.expiresIn) && localStorage.getItem(localStorageKey) === \"true\") {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    AuthService.prototype.isIdTokenValid = function () {\n        if (!isBrowser || (Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object)) {\n            return false;\n        }\n        if (this.expiresIn && this.idToken && (Date.now() < this.expiresIn)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    AuthService.prototype.getIdToken = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(this.idToken && this.isIdTokenValid())) return [3, 1];\n                        return [2, (this.idToken)];\n                    case 1:\n                        if (!this.isAuthenticated()) return [3, 3];\n                        return [4, this.renewTokens().then(function (authResult) {\n                                return (authResult.idToken);\n                            })];\n                    case 2: return [2, _a.sent()];\n                    case 3: return [2, 'error getting idToken'];\n                }\n            });\n        });\n    };\n    AuthService.prototype.setSession = function (authResult) {\n        if (!isBrowser || (Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object)) {\n            return;\n        }\n        this.idToken = authResult.idToken;\n        this.profile = authResult.idTokenPayload;\n        if (this.profile && this.profile.exp) {\n            this.expiresIn = (this.profile.exp * 1000) + Date.now();\n            localStorage.setItem(localStorageKey, \"true\");\n            this.router.push(authResult.appState.target);\n        }\n        else if (authResult.expiresIn) {\n            this.expiresIn = authResult.expiresIn * 1000 + Date.now();\n            localStorage.setItem(localStorageKey, \"true\");\n            this.router.push(authResult.appState.target);\n        }\n        else {\n        }\n    };\n    AuthService.prototype.renewTokens = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                if (!isBrowser || (Object.entries(this.auth0).length === 0 && this.auth0.constructor === Object)) {\n                    return [2];\n                }\n                if (localStorage.getItem(localStorageKey) !== \"true\") {\n                    return [2, (\"Not logged in\")];\n                }\n                return [2, this.auth0.checkSession({}, function (err, authResult) {\n                        if (err) {\n                            return (err);\n                        }\n                        else {\n                            _this.setSession(authResult);\n                            return (authResult);\n                        }\n                    })];\n            });\n        });\n    };\n    return AuthService;\n}(EventEmitter));\nexport default AuthService;\n"]}]}